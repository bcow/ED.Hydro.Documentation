[
["index.html", "Calculating ED Hydro Parameter Priors Documentation", " Calculating ED Hydro Parameter Priors Betsy Cowdery 2019-05-08 Documentation So far this covers how I calculated all the priors. It may ultimately show how the priors compare to the observed data (and the results of a meta analysis given the PFTs we’re interested in.) ## [1] &quot;leaf_psi_tlp&quot; &quot;wood_psi_tlp&quot; &quot;rwc_tlp_wood&quot; &quot;leaf_density&quot; ## [5] &quot;leaf_psi_min&quot; &quot;leaf_water_cap&quot; &quot;wood_psi_min&quot; &quot;wood_water_cap&quot; ED_name Christoffersen_name BETY_variable_id BETY_prior_id ED_units Christoffersen_units theor.min low.025 low.25 mean upp.75 upp.975 theor.max wood_Kexp avuln_node 1000000291 1000000361 unitless unitless 1e-01 1.00 10.0 NA 100 200.00 NA leaf_elastic_mod epsil_node 1000000294 1000000387 MPa MPa 1e+00 5.00 NA 20.00 NA 50.00 NA wood_elastic_mod epsil_node NA NA MPa MPa 1e+00 5.00 NA 20.00 NA 50.00 NA wood_Kmax kmax_node 1000000290 1000000357 kg H2O / m / s kg m-1 s-1 MPa-1 1e-02 0.10 0.5 NA 5 10.00 NA wood_psi50 p50_node 1000000289 1000000360 m MPa 1e-01 0.50 1.0 NA 4 6.00 NA leaf_psi_osmotic pinot_node 1000000295 1000000388 m MPa 1e-01 0.50 NA 2.00 NA 4.00 NA wood_psi_osmotic pinot_node 1000000298 NA m MPa 1e-01 0.50 NA 2.00 NA 4.00 NA leaf_psi_tlp pitlp_node 1000000284 1000000384 m MPa 5e-01 NA NA NA NA NA 6.00 wood_psi_tlp pitlp_node 1000000301 NA m MPa 1e-01 NA NA NA NA NA NA rwc_tlp_wood rwctlp_node 1000000296 NA unitless unitless NA NA NA NA NA NA NA leaf_water_sat thetas_node 1000000285 1000000358 kg H2O/kg biomass kg kg-1 1e-02 0.40 NA 0.65 NA 0.88 0.99 wood_water_sat thetas_node 1000000286 1000000359 kg H2O/kg biomass kg kg-1 5e-02 0.35 NA NA NA 0.80 0.90 leaf_density NA NA NA kg/m3 NA 1e-07 NA NA NA NA NA 2000.00 leaf_psi_min NA 1000000299 1000000392 m NA 1e-01 NA NA NA NA NA 700.00 leaf_water_cap NA 1000000287 1000000390 kg H2O/kg biomass/m NA 1e-07 NA NA NA NA NA NA wood_psi_min NA 1000000300 NA m NA 1e-01 NA NA NA NA NA NA wood_water_cap NA 1000000288 1000000391 kg H2O/kg biomass/m NA 1e-07 NA NA NA NA NA NA "],
["wdns-liquid-water-density.html", "[wdns]: Liquid water density", " [wdns]: Liquid water density ED variable name : wdns ED variable units: kg/m3 wdns &lt;- 1.000e3 # Liquid water density [kg/m3] "],
["grav-gravity.html", "[grav]: Gravity", " [grav]: Gravity ED variable name : grav ED variable units: m/s2 grav &lt;- 9.80665 # Gravity acceleration [m/s2] "],
["mpa2m-conversion-from-mpa-to-m.html", "[MPa2m]: Conversion from MPa to m", " [MPa2m]: Conversion from MPa to m ED variable name : MPa2m MPa2m &lt;- wdns / grav "],
["wood-density-wood-density.html", "[wood_density]: Wood density", " [wood_density]: Wood density ED variable name : rho ED units: g cm-3 Note! Leaf density is calculated in kg cm-3 because that makes perfect sense … ED variable id: 1000000055 FATES varaiable name: WD In the database, wood_density is unitless. So I’m assuming it can be directly mapped to our wood_density as such: \\[\\frac{WD (gcm^{-2})}{\\rho_w(gcm^{-2})} * \\rho_w(gcm^{-2}) = \\frac{WD (gcm^{-2})}{1(gcm^{-2})} * 1(gcm^{-2})\\] There are multiple priors available for wood density so we are explicitly choosing prior 1000000281 (this was chosen by someone else when the PFT was created.) wood_density_id &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;wood_density&quot;) %&gt;% pull(id) wood_density_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(variable_id == wood_density_id) %&gt;% filter(id == 1000000281) %&gt;% collect() wood_density_prior &lt;- rdistn(wood_density_fit) wood_density_default &lt;- get_ED_default(PFT3_defaults_history, &quot;rho&quot;) prior_plot(prior = wood_density_prior, plot_default = wood_density_default, title = sprintf(&quot;(wood_density): %s&quot;, wood_density_fit$distn), type = &quot;prior&quot;) "],
["sla-specific-leaf-area-sla.html", "[SLA]: Specific Leaf Area (SLA)", " [SLA]: Specific Leaf Area (SLA) And subsequently \\(LMA = (1/SLA)\\) ED variable name : SLA ED variable id: 15 There are multiple priors available for SLA so we are explicitly choosing prior 142 (this was chosen by someone else when the PFT was created.) SLA_id &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;SLA&quot;) %&gt;% pull(id) SLA_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(variable_id == SLA_id) %&gt;% filter(id == 142) %&gt;% collect() SLA_prior &lt;- rdistn(SLA_fit) SLA_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;SLA&quot;) prior_plot(prior = SLA_prior, plot_default = SLA_default, title = sprintf(&quot;(SLA): %s&quot;, SLA_fit$distn), type = &quot;prior&quot;) "],
["leaf-psi-osmotic-leaf-osmotic-water-potential-at-saturation.html", "[leaf_psi_osmotic]: Leaf osmotic water potential at saturation ED BETY Calculation Code", " [leaf_psi_osmotic]: Leaf osmotic water potential at saturation ED ED variable name : leaf_psi_osmotic ED variable units: m BETY NOTE!! The units are NEGATIVE in the database so we can calculate a distribution that is entirely negative. Variable id: 1000000295 Prior id: 1000000388 Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: pinot_node (leaf) FATES variable units: MPa Conversion MPa to m Code i &lt;- which(priors$ED_name == &quot;leaf_psi_osmotic&quot;) prior_in &lt;- priors[i, stats] * MPa2m myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) myfit$score$dist[which.min(myfit$score$RMSE)] ## [1] &quot;weibull&quot; variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_psi_osmotic_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000388 already exists. Parameters look the same. Old: weibull(2.4100, 237.4600) New: weibull(2.4100, 237.4600)&quot; leaf_psi_osmotic_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_psi_osmotic_prior_id) %&gt;% collect() leaf_psi_osmotic_prior &lt;- -rdistn(leaf_psi_osmotic_fit) # NOTE: Need to convert to m from -m leaf_psi_osmotic_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_psi_osmotic&quot;) prior_plot(prior = leaf_psi_osmotic_prior, q = c(0,1), plot_default = leaf_psi_osmotic_default, title = sprintf(&quot; (leaf_psi_osmotic): %s&quot;, leaf_psi_osmotic_fit$distn), type = &quot;data&quot;) "],
["leaf-elastic-mod-leaf-bulk-elastic-modulus.html", "[leaf_elastic_mod]: Leaf bulk elastic modulus ED BETY Calculation Code", " [leaf_elastic_mod]: Leaf bulk elastic modulus ED ED variable name : leaf_elastic_mod ED variable units: MPa Note! This is the only case in which MPa is used instead of m! BETY Variable id: 1000000294 Prior id: 1000000387 Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: epsil_node (leaf) FATES variable units: MPa Conversion None! Code i &lt;- which(priors$ED_name == &quot;leaf_elastic_mod&quot;) prior_in &lt;- priors[i,] myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_elastic_mod_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000387 already exists. Parameters look the same. Old: gamma(3.4400, 0.1600) New: gamma(3.4400, 0.1600)&quot; leaf_elastic_mod_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_elastic_mod_id) %&gt;% collect() leaf_elastic_mod_prior &lt;- rdistn(leaf_elastic_mod_fit) leaf_elastic_mod_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_elastic_mod&quot;) prior_plot(prior = leaf_elastic_mod_prior, q = c(0,.995), plot_default = leaf_elastic_mod_default, title = sprintf(&quot;Leaf bulk elastic modulus (leaf_elastic_mod): %s&quot;, leaf_elastic_mod_fit$distn), type = &quot;data&quot;) ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["leaf-density-density-of-leaf-tissue.html", "[leaf_density]: Density of leaf tissue ED BETY Calculation Code", " [leaf_density]: Density of leaf tissue ED ED variable name : leaf_density ED variable units: kg m-3 BETY Variable id: 1000000304 Prior id: 1000000396 Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. I will use the equation in ED to calcualte the prior and add min and max values to make sure the distribution does not predict values that are not biologically possible. Values added by Betsy and Felicien: # Leaf_density priors[which(priors$ED_name == &quot;leaf_density&quot;), c(&quot;theor.min&quot;, &quot;theor.max&quot;)] &lt;- c(1e-7, 2000) Copies directly from the ED code: max(0.1 * 1.e3, (leaf_elastic_mod(ipft) - 2.03) / 25.4 * 1.e3) But there is a key step here that we need to think about, which is that in the ED code, 0.1 * 1.e3 is the smallest possible value. I encorporate that information by setting 0.1 * 1.e3 as the min theoretical value when fitting the distribution (but remove the max from the equation when calculating the leaf_density_sample.) leaf_density_sample &lt;- (leaf_elastic_mod_prior - 2.03) / 25.4 * 1.e3 Conversion None Code leaf_density_sample &lt;- (leaf_elastic_mod_prior - 2.03) / 25.4 * 1.e3 # Add in the max an min from the priors table i &lt;- which(priors$ED_name == &quot;leaf_density&quot;) prior_in &lt;- priors[i,] # Note here I don&#39;t need to do any units conversion prior_in &lt;- prior_add_samp_data(prior_in, samp = leaf_density_sample) prior_in[,stats] ## # A tibble: 1 x 7 ## theor.min low.025 low.25 mean upp.75 upp.975 theor.max ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 0.0000001 123. 431. 687. 1013. 1862. 2000 myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == &quot;leaf_density&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_density_default &lt;- (get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_elastic_mod&quot;) - 2.03) / 25.4 * 1.e3 leaf_density_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000396 already exists. Parameters look different. Old: weibull(1.8300, 848.7800) New: weibull(1.8300, 845.4600)&quot; leaf_density_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_density_id) %&gt;% collect() leaf_density_prior &lt;- rdistn(leaf_density_fit) prior_plot(prior = leaf_density_prior, q = c(0,.995), plot_default = leaf_density_default, title = sprintf(&quot;Leaf density (leaf_density): %s&quot;, leaf_density_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["leaf-water-sat-leaf-water-content-at-saturation.html", "[leaf_water_sat]: Leaf water content at saturation ED BETY Calculation Code", " [leaf_water_sat]: Leaf water content at saturation ED ED variable name : leaf_water_sat ED variable units: kg H2O/kg biomass BETY Variable id: 1000000285 Prior id: 1000000414 Calculation There are a couple ways to approach this: Either build a prior completely from other priors (ie using the equations from ED and a prior for LMA and leaf_density) or try to do a combination where we use the priovided expert elicitation and the prior distribution for leaf_density. I am going to try doing both just to see how they differ. Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: thetas_node (leaf) FATES variable units: kg kg-1 Conversion The equations between the two are identical except that to get from FATES to ED, must multiply by (water density)/(leaf density) Code Initial testing code leaf_density_prior_1 &lt;- leaf_density_prior leaf_density_prior_2 &lt;- rlnorm(100000, 6.51, .59) # Also trying with lnorm, this is left over from a previous question but I&#39;m including it for now so that the code runs # Following the equation in ED SLA_density &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;SLA&quot;) default_LMA &lt;- 1e3 * 2 / SLA_density # 1.e3 * C2B / SLA(ipft) leaf_water_sat_density &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_water_sat&quot;) leaf_water_sat_default_calc &lt;- (-2.32e4 / default_LMA + 782.) * (1. / (-0.21 * log(1.e4 / default_LMA) + 1.43) - 1.) / leaf_density_default # c(leaf_water_sat_density, leaf_water_sat_default_calc) LMA_prior &lt;- 1e3 * 2 / SLA_prior # Should be analogous to Christoffersen because I&#39;m dividing by wdns instead of leaf_density leaf_water_sat_samp_1_1 &lt;- (-2.32e4 / LMA_prior + 782.) * (1. / (-0.21 * log(1.e4 / LMA_prior) + 1.43) - 1.) / leaf_density_prior_1 leaf_water_sat_samp_1_2 &lt;- (-2.32e4 / LMA_prior + 782.) * (1. / (-0.21 * log(1.e4 / LMA_prior) + 1.43) - 1.) / leaf_density_prior_2 prior_in_1_1 &lt;- data.frame(low.025 = quantile(leaf_water_sat_samp_1_1, c(.025), na.rm = TRUE), low.25 = quantile(leaf_water_sat_samp_1_1, c(.25), na.rm = TRUE), mean = quantile(leaf_water_sat_samp_1_1, c(.5), na.rm = TRUE), upp.75 = quantile(leaf_water_sat_samp_1_1, c(.75), na.rm = TRUE), upp.975 = quantile(leaf_water_sat_samp_1_1, c(.975), na.rm = TRUE)) myfit_1_1 &lt;- prior_get_fit(prior_in_1_1, accepted_dists, plot = FALSE) ## Warning: Unknown columns: `theor.min`, `theor.max` myfit_1_1$score$dist[which.min(myfit_1_1$score$RMSE)] ## [1] &quot;exp&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_1_1 &lt;- rexp(1000, myfit_1_1$dists$exp[1]) prior_in_1_2 &lt;- data.frame(low.025 = quantile(leaf_water_sat_samp_1_2, c(.025), na.rm = TRUE), low.25 = quantile(leaf_water_sat_samp_1_2, c(.25), na.rm = TRUE), mean = quantile(leaf_water_sat_samp_1_2, c(.5), na.rm = TRUE), upp.75 = quantile(leaf_water_sat_samp_1_2, c(.75), na.rm = TRUE), upp.975 = quantile(leaf_water_sat_samp_1_2, c(.975), na.rm = TRUE)) myfit_1_2 &lt;- prior_get_fit(prior_in_1_2, accepted_dists, plot = FALSE) ## Warning: Unknown columns: `theor.min`, `theor.max` myfit_1_2$score$dist[which.min(myfit_1_2$score$RMSE)] ## [1] &quot;lnorm&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_1_2 &lt;- rlnorm(1000, myfit_1_2$dists$lnorm[1], myfit_1_2$dists$lnorm[2]) # Using the data i &lt;- which(priors$ED_name == &quot;leaf_water_sat&quot;) myfit_2 &lt;- prior_get_fit(priors[i,], accepted_dists, plot = FALSE) myfit_2$score$dist[which.min(myfit_2$score$RMSE)] ## [1] &quot;norm&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_2 &lt;- rnorm(1000, myfit_2$dists$norm[1], myfit_2$dists$norm[2]) calc_2_1 &lt;- leaf_water_sat_prior_2 * (wdns/(leaf_density_prior_1)) prior_in_2_1 &lt;- data.frame(low.025 = quantile(calc_2_1, c(.025), na.rm = TRUE), low.25 = quantile(calc_2_1, c(.25), na.rm = TRUE), mean = quantile(calc_2_1, c(.5), na.rm = TRUE), upp.75 = quantile(calc_2_1, c(.75), na.rm = TRUE), upp.975 = quantile(calc_2_1, c(.975), na.rm = TRUE)) myfit_2_1 &lt;- prior_get_fit(prior_in_2_1, accepted_dists, plot = FALSE) ## Warning: Unknown columns: `theor.min`, `theor.max` myfit_2_1$score$dist[which.min(myfit_2_1$score$RMSE)] ## [1] &quot;lnorm&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_2_1 &lt;- rlnorm(1000, myfit_2_1$dists$lnorm[1], myfit_2_1$dists$lnorm[2]) calc_2_2 &lt;- leaf_water_sat_prior_2 * (wdns/(leaf_density_prior_2)) prior_in_2_2 &lt;- data.frame(low.025 = quantile(calc_2_2, c(.025), na.rm = TRUE), low.25 = quantile(calc_2_2, c(.25), na.rm = TRUE), mean = quantile(calc_2_2, c(.5), na.rm = TRUE), upp.75 = quantile(calc_2_2, c(.75), na.rm = TRUE), upp.975 = quantile(calc_2_2, c(.975), na.rm = TRUE)) myfit_2_2 &lt;- prior_get_fit(prior_in_2_2, accepted_dists, plot = FALSE) ## Warning: Unknown columns: `theor.min`, `theor.max` myfit_2_2$score$dist[which.min(myfit_2_2$score$RMSE)] ## [1] &quot;lnorm&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_2_2 &lt;- rlnorm(1000, myfit_2_2$dists$lnorm[1], myfit_2_2$dists$lnorm[2]) df &lt;- data.frame(leaf_water_sat_prior_1_1, leaf_water_sat_prior_1_2, leaf_water_sat_prior_2_1, leaf_water_sat_prior_2_2) df2 &lt;- df %&gt;% gather(key = &quot;prior&quot;) %&gt;% mutate(leaf_dens_dist = case_when( prior == &quot;leaf_water_sat_prior_1_1&quot; ~ &quot;Weibull&quot;, prior == &quot;leaf_water_sat_prior_1_2&quot; ~ &quot;Log Normal&quot;, prior == &quot;leaf_water_sat_prior_2_1&quot; ~ &quot;Weibull&quot;, prior == &quot;leaf_water_sat_prior_2_2&quot; ~ &quot;Log Normal&quot; )) %&gt;% mutate(prior_or_data = case_when( prior == &quot;leaf_water_sat_prior_1_1&quot; ~ &quot;LMA_prior&quot;, prior == &quot;leaf_water_sat_prior_1_2&quot; ~ &quot;LMA_prior&quot;, prior == &quot;leaf_water_sat_prior_2_1&quot; ~ &quot;leaf_water_sat_exp_elicit&quot;, prior == &quot;leaf_water_sat_prior_2_2&quot; ~ &quot;leaf_water_sat_exp_elicit&quot; )) ggplot(data = df2) + geom_density(aes(x = value, color = prior_or_data, linetype = leaf_dens_dist)) + geom_vline(aes(xintercept = leaf_water_sat_density)) + geom_point(aes(x = .03, y = 0)) + geom_point(aes(x = 1.5, y = 0)) + geom_point(aes(x = 2, y = 0)) + xlim(-.25, 4) ## Warning: Removed 37 rows containing non-finite values (stat_density). From this point, we can see that just using the equations in the ED code makes the distributions predict low values which is could be a problem given that these values should not be zero and that the distribution underpredicts both in relation to the default value and the values that Felicien gave me. Thus I would create the prior using the expert elicitation values provided by Brad. I am also comfortable with chooseing the best fit distribution for leaf_density which is the weibull distribution instead of trying to come up with a reason why we should make leaf density log normal instead. The log normal was the best if I didn’t include the lower bound - that’s why I wanted to look at it… Actual code i &lt;- which(priors$ED_name == &quot;leaf_water_sat&quot;) myfit_0 &lt;- prior_get_fit(priors[i,], accepted_dists, plot = FALSE) myfit_0$score$dist[which.min(myfit_0$score$RMSE)] ## [1] &quot;norm&quot; # I&#39;m skipping steps here just for the sake of time &amp; sanity leaf_water_sat_prior_0 &lt;- rnorm(100000, myfit_0$dists$norm[1], myfit_0$dists$norm[2]) leaf_water_sat_sample &lt;- leaf_water_sat_prior_0 * (wdns/(leaf_density_prior)) # plot(density(leaf_water_sat_sample), main = &quot;leaf water sat sample without fitting&quot;) # In this case I&#39;m not using the function I built because here it wouldn&#39;t make sense. prior_in &lt;- data.frame(low.025 = quantile(leaf_water_sat_sample, c(.025), na.rm = TRUE), low.25 = quantile(leaf_water_sat_sample, c(.25), na.rm = TRUE), mean = quantile(leaf_water_sat_sample, c(.5), na.rm = TRUE), upp.75 = quantile(leaf_water_sat_sample, c(.75), na.rm = TRUE), upp.975 = quantile(leaf_water_sat_sample, c(.975), na.rm = TRUE)) myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) ## Warning: Unknown columns: `theor.min`, `theor.max` variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_water_sat_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000414 already exists. Parameters look different. Old: lnorm(-0.0400, 0.6400) New: lnorm(-0.0500, 0.6300)&quot; leaf_water_sat_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_water_sat_prior_id) %&gt;% collect() leaf_water_sat_prior &lt;- rdistn(leaf_water_sat_fit) leaf_water_sat_density &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_water_sat&quot;) prior_plot(prior = leaf_water_sat_prior, q = c(0,.995), plot_default = leaf_water_sat_density, title = sprintf(&quot;Leaf water content at saturation (leaf_water_sat): %s&quot;, leaf_water_sat_fit$distn), type = &quot;mixed&quot;) ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["leaf-psi-tlp-leaf-water-potential-at-turgor-loss-point.html", "[leaf_psi_tlp]: Leaf water potential at turgor loss point ED BETY Calculation Code", " [leaf_psi_tlp]: Leaf water potential at turgor loss point ED ED variable name : leaf_psi_tlp ED variable units: m BETY Variable id: 1000000284 Prior id: 1000000384 NOTE!! The units are NEGATIVE in the database so we can calculate a distribution that is entirely negative. Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. I will use the equation in ED to calcualte the prior and add min and max values to make sure the distribution does not predict values that are not biologically possible. Values added by Betsy and Felicien: # Leaf_psi_tlp priors[which(priors$ED_name == &quot;leaf_psi_tlp&quot;), c(&quot;theor.min&quot;, &quot;theor.max&quot;)] &lt;- c(-6, -0.5) Code directly from ED: leaf_elastic_mod(ipft) * (leaf_psi_osmotic(ipft) / MPa2m) / (leaf_elastic_mod(ipft) + leaf_psi_osmotic(ipft) / MPa2m) * MPa2m Thus, leaf_psi_tlp is calculated purely from other parameters: leaf_psi_osmotic and leaf_elastic_mod leaf_psi_tlp_samp &lt;- (leaf_psi_osmotic_prior * (leaf_elastic_mod_prior * MPa2m))/ (leaf_psi_osmotic_prior + (leaf_elastic_mod_prior * MPa2m)) Conversion Remember that leaf_elastic_mod is MPa, where everything else is m! Code leaf_psi_tlp_samp &lt;- (leaf_psi_osmotic_prior * (leaf_elastic_mod_prior * MPa2m))/ (leaf_psi_osmotic_prior + (leaf_elastic_mod_prior * MPa2m)) summary(leaf_psi_tlp_samp) ## Min. 1st Qu. Median Mean 3rd Qu. ## -113807.0778 -326.5276 -231.4694 -242.6403 -154.0157 ## Max. ## 1131399.7839 # Add in the max an min from the priors table i &lt;- which(priors$ED_name == &quot;leaf_psi_tlp&quot;) prior_in &lt;- priors[i,stats] * MPa2m # Convert from MPa to m prior_in &lt;- prior_add_samp_data(prior_in, samp = -leaf_psi_tlp_samp) prior_in[,stats] ## theor.min low.025 low.25 mean upp.75 upp.975 ## 1 50.98581065 NA 154.0156705 231.4693537 326.5275613 NA ## theor.max ## 1 611.8297278 myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;leaf_psi_tlp&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_psi_tlp_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000384 already exists. Parameters look different. Old: lnorm(5.4200, 0.5400) New: lnorm(5.4200, 0.5300)&quot; leaf_psi_tlp_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_psi_tlp_prior_id) %&gt;% collect() leaf_psi_tlp_prior &lt;- -rdistn(leaf_psi_tlp_fit) # Remember to flip back over for psi leaf_psi_tlp_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_psi_tlp&quot;) # plot(density(leaf_psi_tlp_prior), main = &quot;leaf_psi_tlp prior&quot;) # abline(v = get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_psi_tlp&quot;), col = &quot;blue&quot;, lwd = 2) # abline(v = quantile(leaf_psi_osmotic_prior, c(.025, .975)), lty = 2) # legend(&quot;topleft&quot;,legend=c(&quot;Prior&quot;, &quot;95% CI&quot;, &quot;ED PFT 3 Default&quot;), col=c(&quot;black&quot;, &quot;black&quot;,&quot;blue&quot;), lwd = c(2,1,2), lty = c(1,2,1)) prior_plot(prior = leaf_psi_tlp_prior, q = c(.005,1), plot_default = leaf_psi_tlp_default, title = sprintf(&quot;(leaf_psi_tlp): %s&quot;, leaf_psi_tlp_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["leaf-water-cap-leaf-hydaulic-capacitance-.html", "[leaf_water_cap]: Leaf hydaulic capacitance. ED BETY Calculation Code", " [leaf_water_cap]: Leaf hydaulic capacitance. ED ED variable name : leaf_water_cap ED variable units: kg H2O/kg biomass/m BETY Variable id: 1000000287 Prior id: 1000000405 NOTE: units in BETY are g H2O / kg biomass / m! This is because we needed to multiply by 1000 to get large enough values to fit the distribution. Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. I will use the equation in ED to calcualte the prior and add min and max values to make sure the distribution does not predict values that are not biologically possible. Values added by Betsy and Felicien: # Leaf_water_cap priors[which(priors$ED_name == &quot;leaf_water_cap&quot;), c(&quot;theor.min&quot;, &quot;theor.max&quot;)] &lt;- c(1e-7, NA) Equation copied directly from ED: (1. - leaf_psi_osmotic(ipft) / (4. * leaf_psi_tlp(ipft))) * leaf_water_sat(ipft) / (4. * abs(leaf_psi_tlp(ipft))) Conversion Don’t forget about the switch from kg to g! Code leaf_water_cap_samp &lt;- 1000 * (1 - leaf_psi_osmotic_prior / (4 * leaf_psi_tlp_prior)) * (leaf_water_sat_prior / (4 * abs(leaf_psi_tlp_prior))) # * (wdns/leaf_density_prior) leaf_water_cap_samp &lt;- leaf_water_cap_samp[0 &lt; leaf_water_cap_samp] default_leaf_water_cap &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_water_cap&quot;) plot(density(leaf_water_cap_samp)) abline(v = default_leaf_water_cap) # Add in the max an min from the priors table i &lt;- which(priors$ED_name == &quot;leaf_water_cap&quot;) prior_in &lt;- priors[i,stats] prior_in[,&quot;theor.min&quot;] &lt;- NA # prior_in[,&quot;theor.max&quot;] &lt;- max(.35 * (1/MPa2m) * (wdns/leaf_density_prior) ) prior_in &lt;- prior_add_samp_data(prior_in, samp = leaf_water_cap_samp) prior_in[,stats] ## # A tibble: 1 x 7 ## theor.min low.025 low.25 mean upp.75 upp.975 theor.max ## &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 NA 0.162 0.448 0.748 1.25 3.28 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;leaf_water_cap&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_water_cap_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000405 already exists. Parameters look the same. Old: lnorm(-0.2900, 0.7600) New: lnorm(-0.2900, 0.7600)&quot; leaf_water_cap_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_water_cap_prior_id) %&gt;% collect() leaf_water_cap_prior &lt;- rdistn(leaf_water_cap_fit) * (1/1000) leaf_water_cap_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_water_cap&quot;) prior_plot(prior = leaf_water_cap_prior, q = c(0,.975), plot_default = leaf_water_cap_default, title = sprintf(&quot;(leaf_water_cap): %s&quot;, leaf_water_cap_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["leaf-psi-min-leaf-minimum-water-potential.html", "[leaf_psi_min]: Leaf minimum water potential ED BETY Calculation Code", " [leaf_psi_min]: Leaf minimum water potential This is calculated from [leaf_rwc_min]: Leaf minimum relative water content or leaf residual fraction, which I have not added to BETY. ED ED variable name : leaf_psi_min ED variable units: m BETY Variable id: 1000000299 Prior id: 1000000392 NOTE!! The units are NEGATIVE in the database so we can calculate a distribution that is entirely negative. Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. I will use the equation in ED to calcualte the prior and add min and max values to make sure the distribution does not predict values that are not biologically possible. Values added by Betsy and Felicien: # Leaf_psi_min priors[which(priors$ED_name == &quot;leaf_psi_min&quot;), c(&quot;theor.min&quot;, &quot;theor.max&quot;)] &lt;- c(-700, -0.1) Code copied from ED: leaf_rwc_min = 0.01 * leaf_elastic_mod(ipft) + 0.17 leaf_psi_min = (leaf_rwc_min(ipft) - 1.) * leaf_water_sat(ipft) / leaf_water_cap(ipft) Conversion None Code leaf_rwc_min_samp = 0.01 * leaf_elastic_mod_prior + 0.17 leaf_psi_min_samp = (leaf_rwc_min_samp - 1.) * leaf_water_sat_prior / leaf_water_cap_prior # Add in the max an min from the priors table i &lt;- which(priors$ED_name == &quot;leaf_psi_min&quot;) prior_in &lt;- priors[i,stats] * MPa2m # Convert from MPa to m prior_in &lt;- prior_add_samp_data(prior_in, samp = -leaf_psi_min_samp) prior_in[,stats] ## theor.min low.025 low.25 mean upp.75 upp.975 ## 1 10.19716213 102.5904502 390.2174934 772.7645946 1538.670318 5680.693906 ## theor.max ## 1 71380.13491 myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;leaf_psi_min&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) leaf_psi_min_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000392 already exists. Parameters look the same. Old: lnorm(6.6500, 1.0200) New: lnorm(6.6500, 1.0200)&quot; leaf_psi_min_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == leaf_psi_min_prior_id) %&gt;% collect() leaf_psi_min_prior &lt;- -rdistn(leaf_psi_min_fit) # Remember to flip psi default_leaf_psi_min &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;leaf_psi_min&quot;) prior_plot(prior = leaf_psi_min_prior, q = c(.025,1), plot_default = default_leaf_psi_min, title = sprintf(&quot;leaf_psi_min: %s&quot;, leaf_psi_min_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["wood-psi-osmotic-sapwood-osmotic-water-potential-at-saturation.html", "[wood_psi_osmotic]: Sapwood osmotic water potential at saturation ED BETY Calculation", " [wood_psi_osmotic]: Sapwood osmotic water potential at saturation ED ED variable name : wood_psi_osmotic ED variable units: m BETY Variable id: 1000000298 Prior id: 1000000410 NOTE!! The units are NEGATIVE in the database so we can calculate a distribution that is entirely negative. Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: pinot_node (stem) FATES variable units: m Conversion MPa to m Code i &lt;- which(priors$ED_name == &quot;wood_psi_osmotic&quot;) prior_in &lt;- priors[i, stats] * MPa2m myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) myfit$score$dist[which.min(myfit$score$RMSE)] ## [1] &quot;weibull&quot; variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_psi_osmotic_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000410 already exists. Parameters look the same. Old: weibull(2.4100, 237.4600) New: weibull(2.4100, 237.4600)&quot; wood_psi_osmotic_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi_osmotic_prior_id) %&gt;% collect() wood_psi_osmotic_prior &lt;- -rdistn(wood_psi_osmotic_fit) wood_psi_osmotic_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_psi_osmotic&quot;) prior_plot(prior = wood_psi_osmotic_prior, q = c(0,1), plot_default = wood_psi_osmotic_default, title = sprintf(&quot;Sapwood osmotic water potential at saturation (wood_psi_osmotic): %s&quot;, wood_psi_osmotic_fit$distn), type = &quot;data&quot;) "],
["wood-elastic-mod-sapwood-bulk-elastic-modulus.html", "[wood_elastic_mod]: Sapwood bulk elastic modulus ED BETY Calculation Code", " [wood_elastic_mod]: Sapwood bulk elastic modulus ED ED variable name : wood_elastic_mod ED variable units: MPa Note! This is the only case in which MPa is used instead of m! BETY Variable id: 1000000303 Prior id: 1000000394 Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: epsil_node (stem) FATES variable units: MPa Conversion None! Code i &lt;- which(priors$ED_name == &quot;wood_elastic_mod&quot;) prior_in &lt;- priors[i,] myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_elastic_mod_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000394 already exists. Parameters look the same. Old: gamma(3.4400, 0.1600) New: gamma(3.4400, 0.1600)&quot; wood_elastic_mod_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_elastic_mod_id) %&gt;% collect() wood_elastic_mod_prior &lt;- rdistn(wood_elastic_mod_fit) wood_elastic_mod_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_elastic_mod&quot;) prior_plot(prior = wood_elastic_mod_prior, q = c(0,1), plot_default = wood_elastic_mod_default, title = sprintf(&quot;wood bulk elastic modulus (wood_elastic_mod): %s&quot;, wood_elastic_mod_fit$distn), type = &quot;data&quot;) # [wood_water_sat]: Sapwood water content at saturation {-} ## ED {-} - ED variable name: wood_water_sat - ED variable units: kg H2O/kg biomass ## BETY {-} - Variable id: - Prior id: ## Calculation {-} ### Expert elicitation {-} Expert elicitation provided by Brad Christoffersen - FATES variable name: thetas_node (stem) - FATES variable units: kg kg-1 ### Conversion {-} multiply by the density of water over wood density ## Code {-} ```r i &lt;- which(priors$ED_name == “wood_water_sat”) myfit_0 &lt;- prior_get_fit(priors[i,], accepted_dists, plot = FALSE) myfit_0\\(score\\)dist[which.min(myfit_0\\(score\\)RMSE)] ``` ## [1] &quot;norm&quot; ```r # I’m skipping steps here for the sake of time and sanity # Normal is the best fit wood_water_sat_prior_0 &lt;- rnorm(100000, myfit_0\\(dists\\)norm[1], myfit_0\\(dists\\)norm[2]) wood_water_sat_sample &lt;- wood_water_sat_prior_0 * (wdns/(wood_density_prior * 1e3)) # Note that here we have to multiply by 1e3 because of the units of wood density # In this case I’m not using the function I built because here it wouldn’t make sense. prior_in &lt;- data.frame(low.025 = quantile(wood_water_sat_sample, c(.025), na.rm = TRUE), low.25 = quantile(wood_water_sat_sample, c(.25), na.rm = TRUE), mean = quantile(wood_water_sat_sample, c(.5), na.rm = TRUE), upp.75 = quantile(wood_water_sat_sample, c(.75), na.rm = TRUE), upp.975 = quantile(wood_water_sat_sample, c(.975), na.rm = TRUE)) myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) ``` ## Warning: Unknown columns: `theor.min`, `theor.max` ```r variable_id.in &lt;- tbl(bety,“variables”) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- “plants” best.fit.name &lt;- myfit\\(score\\)dist[which.min(myfit\\(score\\)RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(“Name”, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_water_sat_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == “Para1”) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == “Para2”) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == “Para3”) %&gt;% pull(value)) ``` ## [1] &quot;Entry with id = 1000000415 already exists. Parameters look different. Old: gamma(14.2200, 16.8600) New: gamma(14.1000, 16.7400)&quot; ```r wood_water_sat_fit &lt;- tbl(bety, “priors”) %&gt;% filter(id == wood_water_sat_prior_id) %&gt;% collect() wood_water_sat_prior &lt;- rdistn(wood_water_sat_fit) wood_water_sat_density &lt;- get_ED_default(“/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml”, “wood_water_sat”) prior_plot(prior = wood_water_sat_prior, q = c(0,.995), plot_default = wood_water_sat_density, title = sprintf(“Wood water content at saturation (wood_water_sat): %s”, wood_water_sat_fit$distn), type = “mixed”) ``` ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["wood-psi-tlp-sapwood-water-potential-at-turgor-loss-point.html", "[wood_psi_tlp]: Sapwood water potential at turgor loss point ED BETY Calculation Code", " [wood_psi_tlp]: Sapwood water potential at turgor loss point ED ED variable name: wood_psi_tlp ED variable units: m BETY Variable id: `` Prior id: `` NOTE!! The units are NEGATIVE in the database so we can calculate a distribution that is entirely negative. Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. There is a FATES parameter but it is calculated from other parameters FATES variable name: pitlp_node FATES variable units: MPa Constraints we added - wood_psi_tlp &gt; .1 MPa (this was given as a boundary for other psi variables) Conversion Calculated from other parameters: wood_psi_osmotic and wood_elastic_mod Remember that wood_elastic_mod is MPa, where everything else is m! Code wood_psi_tlp_samp = (wood_psi_osmotic_prior * wood_elastic_mod_prior * MPa2m)/ (wood_psi_osmotic_prior + wood_elastic_mod_prior * MPa2m) wood_psi_tlp_samp &lt;- (wood_psi_osmotic_prior * wood_elastic_mod_prior * MPa2m)/ (wood_psi_osmotic_prior + wood_elastic_mod_prior * MPa2m) summary(wood_psi_tlp_samp) ## Min. 1st Qu. Median Mean 3rd Qu. ## -154445.9878 -326.2067 -231.7237 -233.3153 -154.4712 ## Max. ## 1812632.9239 i &lt;- which(priors$ED_name == &quot;wood_psi_tlp&quot;) prior_in &lt;- priors[i,stats] * MPa2m # Convert from MPa to m prior_in &lt;- prior_add_samp_data(prior_in, samp = -wood_psi_tlp_samp) prior_in[,stats] ## theor.min low.025 low.25 mean upp.75 upp.975 ## 1 10.19716213 50.43953599 154.4711582 231.7236895 326.2067463 611.1453491 ## theor.max ## 1 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;wood_psi_tlp&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_psi_tlp_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000416 already exists. Parameters look the same. Old: lnorm(5.4300, 0.5500) New: lnorm(5.4300, 0.5500)&quot; wood_psi_tlp_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi_tlp_prior_id) %&gt;% collect() wood_psi_tlp_prior &lt;- -rdistn(wood_psi_tlp_fit) # Remember to flip back over for psi wood_psi_tlp_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_psi_tlp&quot;) prior_plot(prior = wood_psi_tlp_prior, q = c(.005,1), plot_default = wood_psi_tlp_default, title = sprintf(&quot;(wood_psi_tlp): %s&quot;, wood_psi_tlp_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 500 rows containing non-finite values (stat_density). "],
["wood-water-cap-wood-hydaulic-capacitance.html", "[wood_water_cap]: Wood hydaulic capacitance ED BETY Calculation Code", " [wood_water_cap]: Wood hydaulic capacitance ED ED variable name : wood_water_cap ED variable units: kg H2O/kg biomass/m BETY Different units in BETY so we can fit a distribution! The numbers were so small that I couldn’t get the fitting function to work until I scaled the variable up! BETY varaible units: g H2O / kg biomass / m Calculation Expert elicitation No expert elicitation provided by Brad Christoffersen. Constraints we added - wood_water_cap &gt; 1e-07 kg H2O/kg biomass/m Code wood_water_cap_samp &lt;- 1000 * (1 - wood_psi_osmotic_prior / (4 * wood_psi_tlp_prior)) * (wood_water_sat_prior / (4 * abs(wood_psi_tlp_prior))) summary(wood_water_cap_samp) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -20.9012107 0.4467813 0.6273708 0.6832138 0.8677006 5.9017071 i &lt;- which(priors$ED_name == &quot;wood_water_cap&quot;) prior_in &lt;- priors[i,stats] prior_in &lt;- prior_add_samp_data(prior_in, samp = wood_water_cap_samp) prior_in[,stats] ## # A tibble: 1 x 7 ## theor.min low.025 low.25 mean upp.75 upp.975 theor.max ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 0.0000001 0.179 0.447 0.627 0.868 1.61 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;wood_water_cap&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_water_cap_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000417 already exists. Parameters look the same. Old: lnorm(-0.4700, 0.4900) New: lnorm(-0.4700, 0.4900)&quot; wood_water_cap_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_water_cap_prior_id) %&gt;% collect() wood_water_cap_prior &lt;- rdistn(wood_water_cap_fit) * (1/1000) # Convert back to kg wood_water_cap_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_water_cap&quot;) prior_plot(prior = wood_water_cap_prior, q = c(0,.975), plot_default = wood_water_cap_default, title = sprintf(&quot;(wood_water_cap): %s&quot;, wood_water_cap_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["wood-psi-min-sapwood-minimum-relative-water-content-or-sapwood-residual-fraction.html", "[wood_psi_min]: Sapwood minimum relative water content or Sapwood residual fraction ED BETY Calculation Code", " [wood_psi_min]: Sapwood minimum relative water content or Sapwood residual fraction ED ED variable name : wood_psi_min Ed variable units: m BETY Negative units in BETY so we can fit a distribution! BETY varaible units: -m Calculation Expert elicitation There are no FATES parameters Constraints we added - wood_psi_min &gt; .1 MPa (this was given as a boundary for other psi variables) Code Calculated from other priors. Should I put wood_rwc_min and rwc_tlp_wood in the database too? rwc_tlp_wood_samp &lt;- 1. - (1. - 0.75 * wood_density_prior) / (2.74 + 2.01 * wood_density_prior) wood_rwc_min_samp = wood_elastic_mod_prior * (1. - rwc_tlp_wood_samp) / (wood_psi_osmotic_prior / MPa2m) + 1. wood_psi_min_samp = (wood_rwc_min_samp - 1.) * wood_water_sat_prior / wood_water_cap_prior # Add in the max an min from the priors table i &lt;- which(priors$ED_name == &quot;wood_psi_min&quot;) prior_in &lt;- priors[i,stats] * MPa2m # Convert from MPa to m prior_in &lt;- prior_add_samp_data(prior_in, samp = -wood_psi_min_samp) prior_in[,stats] ## theor.min low.025 low.25 mean upp.75 upp.975 ## 1 10.19716213 213.8437291 770.018778 1482.242554 2862.761438 10605.60126 ## theor.max ## 1 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) variable_id.in &lt;- tbl(bety, &quot;variables&quot;) %&gt;% filter(name == &quot;wood_psi_min&quot;) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_psi_min_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000419 already exists. Parameters look the same. Old: lnorm(7.3000, 0.9800) New: lnorm(7.3000, 0.9800)&quot; wood_psi_min_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi_min_prior_id) %&gt;% collect() wood_psi_min_prior &lt;- -rdistn(wood_psi_min_fit) # Remember to flip psi default_wood_psi_min &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_psi_min&quot;) prior_plot(prior = wood_psi_min_prior, q = c(.025,1), plot_default = default_wood_psi_min, title = sprintf(&quot;wood_psi_min: %s&quot;, wood_psi_min_fit$distn), type = &quot;equation&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["wood-kmax-maximum-hydraulic-conductivity-of-the-stem.html", "[wood_Kmax]: Maximum hydraulic conductivity of the stem ED BETY Calculation Code", " [wood_Kmax]: Maximum hydraulic conductivity of the stem ED ED variable name : wood_Kmax ED variable units: kg H2O / m / s Note! This is the only case in which MPa is used instead of m! BETY Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: kmax_node FATES variable units: kg m-1 s-1 MPa-1 Conversion I don’t think we need to multiply by the density of water … which is confusing. Code i &lt;- which(priors$ED_name == &quot;wood_Kmax&quot;) prior_in &lt;- priors[i, stats] / MPa2m myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) myfit$score$dist[which.min(myfit$score$RMSE)] ## [1] &quot;exp&quot; variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_Kmax_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000418 already exists. Parameters look the same. Old: exp(32.6600) New: exp(32.6600)&quot; wood_Kmax_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_Kmax_prior_id) %&gt;% collect() wood_Kmax_prior &lt;- rdistn(wood_Kmax_fit) # NOTE: Need to convert to m from -m wood_Kmax_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_Kmax&quot;) prior_plot(prior = wood_Kmax_prior, q = c(0,.975), plot_default = wood_Kmax_default, title = sprintf(&quot;Maximum hydraulic conductivity of the stem (wood_Kmax): %s&quot;, wood_Kmax_fit$distn), type = &quot;data&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["wood-psi50-water-potential-at-which-50-of-stem-conductivity-is-lost.html", "[wood_psi50]: Water potential at which 50% of stem conductivity is lost ED BETY Calculation Code", " [wood_psi50]: Water potential at which 50% of stem conductivity is lost ED ED variable name : wood_psi50 ED variable units: m BETY Negative units in BETY so we can fit a distribution! BETY varaible units: -m Calculation NOTE: There is an ERROR in the ED code for the equation for wood_psi50 Should be: (-1.09-(3.57 * rho(ipft) ^ 1.73) * MPa2m This one is tricky, do we keep the normal distribution because it’s the best fit? Expert elicitation FATES varaiable name: p50_node (stem) FATES variable units: MPa Conversion MPa to m Code Using the best fit norm i &lt;- which(priors$ED_name == &quot;wood_psi50&quot;) prior_in &lt;- priors[i, stats] * MPa2m prior_in ## theor.min low.025 low.25 mean upp.75 upp.975 ## 1 10.19716213 50.98581065 101.9716213 NA 407.8864852 611.8297278 ## theor.max ## 1 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) myfit$score$dist[which.min(myfit$score$RMSE)] ## [1] &quot;norm&quot; variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_psi50_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000360 already exists. Parameters look the same. Old: norm(284.6500, 176.3200) New: norm(284.6500, 176.3200)&quot; wood_psi50_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi50_prior_id) %&gt;% collect() wood_psi50_prior &lt;- -rdistn(wood_psi50_fit) # NOTE: Need to convert to m from -m # Calculating default by hand because it is calculated wrong in ED! wood_psi50_default &lt;- (-1.09 - (3.57 * wood_density_default ^ 1.73)) * MPa2m wrong_wood_psi50_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_psi50&quot;) p &lt;- prior_plot(prior = wood_psi50_prior, q = c(0,1), plot_default = wood_psi50_default, title = sprintf(&quot;Water potential at which 50perc. of stem cond. is lost (wood_psi50): %s&quot;, wood_psi50_fit$distn), type = &quot;data&quot;) p + geom_vline(aes(xintercept = wrong_wood_psi50_default), color = &quot;gray&quot;, linetype = &quot;dashed&quot;) + geom_vline(aes(xintercept = quantile(wood_psi50_prior, .975)), color = &quot;blue&quot;, linetype = &quot;dashed&quot;) quantile(wood_psi50_prior, .975) ## 97.5% ## 62.58123362 A positive number is within the 95% CI of the distribution so in this case, I’m going to choose a log normal distriburtion even though it is not the best fit. Hopefully this can also be fixed given that we have data for both psi50 and Kexp… Using more realistic lnorm best.fit.name &lt;- &quot;lnorm&quot; best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_psi50_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000420 already exists. Parameters look the same. Old: lnorm(5.2800, 0.8500) New: lnorm(5.2800, 0.8500)&quot; wood_psi50_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi50_prior_id) %&gt;% collect() wood_psi50_prior &lt;- -rdistn(wood_psi50_fit) # NOTE: Need to convert to m from -m # Calculating default by hand because it is calculated wrong in ED! wood_psi50_default &lt;- (-1.09 - (3.57 * wood_density_default ^ 1.73)) * MPa2m wrong_wood_psi50_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_psi50&quot;) prior_plot(prior = wood_psi50_prior, q = c(0.025,1), plot_default = wood_psi50_default, title = sprintf(&quot;Water potential at which 50perc. of stem cond. is lost (wood_psi50): %s&quot;, wood_psi50_fit$distn), type = &quot;data&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). "],
["wood-kexp-exponent-for-the-hydraulic-vulnerability-curve-of-stem-conductivity.html", "[wood_Kexp]: Exponent for the hydraulic vulnerability curve of stem conductivity ED BETY Calculation Code Wood Density SLA Kmax Psi50 Kexp", " [wood_Kexp]: Exponent for the hydraulic vulnerability curve of stem conductivity … under the Weibull function 1/(1+(psi/psi50) ^ Kexp_stem) ED ED variable name : wood_Kexp ED variable units: unitless BETY Calculation Expert elicitation Expert elicitation provided by Brad Christoffersen FATES varaiable name: avuln_node (stem) FATES variable units: unitless Conversion None! Code i &lt;- which(priors$ED_name == &quot;wood_Kexp&quot;) prior_in &lt;- priors[i, stats] prior_in ## # A tibble: 1 x 7 ## theor.min low.025 low.25 mean upp.75 upp.975 theor.max ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 0.1 1 10 NA 100 200 NA myfit &lt;- prior_get_fit(prior_in, accepted_dists, plot = TRUE) myfit$score$dist[which.min(myfit$score$RMSE)] ## [1] &quot;exp&quot; variable_id.in &lt;- tbl(bety,&quot;variables&quot;) %&gt;% filter(name == priors$ED_name[i]) %&gt;% pull(id) phylogeny.in &lt;- &quot;plants&quot; best.fit.name &lt;- myfit$score$dist[which.min(myfit$score$RMSE)] best.fit.dat &lt;- myfit$dists %&gt;% select(one_of(&quot;Name&quot;, best.fit.name)) %&gt;% rename(value := !!best.fit.name, params = Name) wood_Kexp_prior_id &lt;- prior_input(bety, variable_id.in, phylogeny.in, dist.name.in = best.fit.name, parama.in = best.fit.dat %&gt;% filter(params == &quot;Para1&quot;) %&gt;% pull(value), paramb.in = best.fit.dat %&gt;% filter(params == &quot;Para2&quot;) %&gt;% pull(value), paramc.in = best.fit.dat %&gt;% filter(params == &quot;Para3&quot;) %&gt;% pull(value)) ## [1] &quot;Entry with id = 1000000421 already exists. Parameters look the same. Old: exp(0.0200) New: exp(0.0200)&quot; wood_Kexp_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_Kexp_prior_id) %&gt;% collect() wood_Kexp_prior &lt;- rdistn(wood_Kexp_fit) # Calculating default by hand because psi50 is calculated wrong in ED! wood_Kexp_default &lt;- 0.544 * 4. * (-wood_psi50_default / MPa2m) ^ (-0.17) wrong_wood_Kexp_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_Kexp&quot;) p &lt;- prior_plot(prior = wood_Kexp_prior, q = c(0,.975), plot_default = wood_Kexp_default, title = sprintf(&quot;Water potential at which 50perc. of stem cond. is lost (wood_Kexp): %s&quot;, wood_Kexp_fit$distn), type = &quot;data&quot;) p + geom_vline(aes(xintercept = wrong_wood_Kexp_default), color = &quot;gray&quot;, linetype = &quot;dashed&quot;) ## Warning: Removed 2500 rows containing non-finite values (stat_density). Note: here the miscalculation of psi50 in the code barely shows up because the value is divided by a large number. that is used in pecan because that will show me where/how to deal with the changes in variable units, both for all the psi variables that are negative but also for the variables that are multiplied by 1000. bety &lt;- betyConnect(&quot;/fs/data3/ecowdery/pecan/web/config.php&quot;) pftid &lt;- 1000000131 tropical_species &lt;- tbl(bety, &quot;pfts&quot;) %&gt;% dplyr::rename(pft_id = id) %&gt;% filter(pft_id == pftid) %&gt;% inner_join(., tbl(bety, &quot;pfts_species&quot;), by = &quot;pft_id&quot;) %&gt;% inner_join(., tbl(bety, &quot;species&quot;) %&gt;% dplyr::rename(specie_id = id), by = &quot;specie_id&quot;) %&gt;% dplyr::select(one_of(&quot;pft_id&quot;, &quot;name&quot;, &quot;specie_id&quot;, &quot;genus&quot;, &quot;species&quot;, &quot;scientificname&quot;)) %&gt;% collect() variables &lt;- c( &quot;SLA&quot;, &quot;wood_density&quot;, &quot;leaf_elastic_mod&quot;, &quot;wood_elastic_mod&quot;, &quot;leaf_psi_osmotic&quot;, &quot;wood_psi_osmotic&quot;, &quot;rwc_tlp_wood&quot;, &quot;leaf_water_sat&quot;, &quot;wood_water_sat&quot;, &quot;leaf_water_cap&quot;, &quot;wood_water_cap&quot;, &quot;leaf_psi_min&quot;, &quot;wood_psi_min&quot;, &quot;wood_Kmax&quot;, &quot;wood_psi50&quot;, &quot;wood_Kexp&quot; ) variables_ids &lt;- lapply(variables, function(v) tbl(bety, &quot;variables&quot;) %&gt;% filter(name == v) %&gt;% pull(id)) %&gt;% unlist() v_df &lt;- data.frame(variables, variables_ids) species_ids &lt;- unique(tropical_species$specie_id) trait_data &lt;- tbl(bety, &quot;traits&quot;) %&gt;% filter(specie_id %in% species_ids) %&gt;% filter(variable_id %in% variables_ids) %&gt;% collect() Wood Density v_id &lt;- v_df %&gt;% filter(variables == &quot;wood_density&quot;) %&gt;% pull(variables_ids) wood_density_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(variable_id == v_id) %&gt;% filter(id == 1000000281) %&gt;% collect() wood_density_prior &lt;- rdistn(wood_density_fit) wood_density_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;rho&quot;) p &lt;- prior_plot(prior = wood_density_prior, plot_default = wood_density_default, title = sprintf(&quot;(wood_density): %s&quot;, wood_density_fit$distn), type = &quot;prior&quot;) p # obs &lt;- trait_data %&gt;% filter(variable_id == v_df$variables_ids[v_df$variables == &quot;wood_density&quot;]) # p + geom_density(data = obs, aes(x = mean, fill = &quot;obs&quot;), alpha = .3, color = NA) SLA v_id &lt;- v_df %&gt;% filter(variables == &quot;SLA&quot;) %&gt;% pull(variables_ids) SLA_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(variable_id == v_id) %&gt;% filter(id == 142) %&gt;% collect() SLA_prior &lt;- rdistn(SLA_fit) SLA_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;SLA&quot;) p &lt;- prior_plot(prior = SLA_prior, plot_default = SLA_default, title = sprintf(&quot;(SLA): %s&quot;, SLA_fit$distn), type = &quot;prior&quot;) obs &lt;- trait_data %&gt;% filter(variable_id == v_df$variables_ids[v_df$variables == &quot;SLA&quot;]) obs$mean &lt;- obs$mean p + geom_density(data = obs, aes(x = mean, fill = &quot;obs&quot;), alpha = .3, color = NA) Kmax wood_Kmax_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_Kmax_prior_id) %&gt;% collect() wood_Kmax_prior &lt;- rdistn(wood_Kmax_fit) # NOTE: Need to convert to m from -m wood_Kmax_default &lt;- get_ED_default(&quot;/fs/data3/ecowdery/ED.Hydro/parameters/pft3_defaults_history.xml&quot;, &quot;wood_Kmax&quot;) p &lt;- prior_plot(prior = wood_Kmax_prior, q = c(0,.995), plot_default = wood_Kmax_default, title = sprintf(&quot;Maximum hydraulic conductivity of the stem (wood_Kmax): %s&quot;, wood_Kmax_fit$distn), type = &quot;prior&quot;) obs &lt;- trait_data %&gt;% filter(variable_id == v_df$variables_ids[v_df$variables == &quot;wood_Kmax&quot;]) obs$mean &lt;- obs$mean p + geom_density(data = obs, aes(x = mean, fill = &quot;obs&quot;), alpha = .3, color = NA) ## Warning: Removed 500 rows containing non-finite values (stat_density). Psi50 wood_psi50_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_psi50_prior_id) %&gt;% collect() wood_psi50_prior &lt;- -rdistn(wood_psi50_fit) # NOTE: Need to convert to m from -m # Calculating default by hand because it is calculated wrong in ED! wood_psi50_default &lt;- (-1.09 - (3.57 * wood_density_default ^ 1.73)) * MPa2m wrong_wood_psi50_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_psi50&quot;) p &lt;- prior_plot(prior = wood_psi50_prior, q = c(0.025,1), plot_default = wood_psi50_default, title = sprintf(&quot;Water potential at which 50perc. of stem cond. is lost (wood_psi50): %s&quot;, wood_psi50_fit$distn), type = &quot;prior&quot;) obs &lt;- trait_data %&gt;% filter(variable_id == v_df$variables_ids[v_df$variables == &quot;wood_psi50&quot;]) obs$mean &lt;- obs$mean p + geom_density(data = obs, aes(x = mean, fill = &quot;obs&quot;), alpha = .3, color = NA) ## Warning: Removed 2500 rows containing non-finite values (stat_density). Kexp wood_Kexp_fit &lt;- tbl(bety, &quot;priors&quot;) %&gt;% filter(id == wood_Kexp_prior_id) %&gt;% collect() wood_Kexp_prior &lt;- rdistn(wood_Kexp_fit) # Calculating default by hand because psi50 is calculated wrong in ED! wood_Kexp_default &lt;- 0.544 * 4. * (-wood_psi50_default / MPa2m) ^ (-0.17) wrong_wood_Kexp_default &lt;- get_ED_default(PFT3_defaults_history, &quot;wood_Kexp&quot;) p &lt;- prior_plot(prior = wood_Kexp_prior, q = c(0,.5), plot_default = wood_Kexp_default, title = sprintf(&quot;Water potential at which 50perc. of stem cond. is lost (wood_Kexp): %s&quot;, wood_Kexp_fit$distn), type = &quot;prior&quot;) obs &lt;- trait_data %&gt;% filter(variable_id == v_df$variables_ids[v_df$variables == &quot;wood_Kexp&quot;]) p + geom_density(data = obs, aes(x = mean, fill = &quot;obs&quot;), alpha = .3, color = NA) ## Warning: Removed 50000 rows containing non-finite values (stat_density). "],
["taxonomic-name-resolution-when-importing-data-in-to-bety.html", "Taxonomic Name Resolution when Importing Data in to BETY Name Resolution Building a Tropical PFT What I need help with Cases", " Taxonomic Name Resolution when Importing Data in to BETY Name Resolution When users have plant trait data that they want to enter in to the database, the data needs to attributed to a specific species database record. When the user has no other information (such as ID codes like the USDA and FIA codes) the only way to match the species in the data with species entry in the database is through matching of scientific names. But it may be the case that the accepted scientific name has changed since the data was collected (and/or published), or that the data itself contains errors (typos or otherwise) such that the names in the data are not matching with anything that has already been entered in to BETY. It is also the case that BETY does not have a complete record. At this point we need to employ additional tools to help us in resolving taxonomic names. Already in the PEcAn code there exists match_species_id: But this cannot account for fuzzy matching of names (ie spelling errors) and synonyms. 94.match.species: This code is specific to importing data from thr TRY database and experiments with some partial matching through grep statements, but again does not account for synonyms. Outside of PEcAn, there is the Taxonomic Name Resolution Service Additionally, there is an R package taxize which, among other things, provides an R interface between TNRS and R. I recommend checking out their vignettes - you can also just access them on their github. Building a Tropical PFT My goal is not only to import trait data, but to build a PFT that I can used to do runs in the tropics. (How general should this PFT be? That’s a good question!) Right now I’m using a clone of the tropical PFT that was made to be used with FATES. Thus it contains all the imported BETY entries from the ForestGEO Neotropical tree database (http://ctfs.si.edu/webatlas/neotropicaltree/) and more. There are currently 22286 species linked to the PFT, 20811 of which are the ForestGEO entries. If I’m importing data with species that are not in the existing PFT, I need to decide if they should be added. And I suppose I should also make sure there aren’t any species in the PFT that shouldn’t be there. This is something that I have no expertise in so I would like advice. Below I’m loading in all the spcies names from my PFT (id = 1000000131) pftid &lt;- 1000000131 PFT_species &lt;- tbl(bety, &quot;pfts&quot;) %&gt;% dplyr::rename(pft_id = id) %&gt;% filter(pft_id == pftid) %&gt;% inner_join(., tbl(bety, &quot;pfts_species&quot;), by = &quot;pft_id&quot;) %&gt;% inner_join(., tbl(bety, &quot;species&quot;) %&gt;% dplyr::rename(specie_id = id), by = &quot;specie_id&quot;) %&gt;% dplyr::select(one_of(&quot;pft_id&quot;, &quot;name&quot;, &quot;specie_id&quot;, &quot;genus&quot;, &quot;species&quot;, &quot;scientificname&quot;, &quot;notes&quot;)) %&gt;% collect() # Check that all the ForestGEO species are in the PFT (they are) nForestGEO &lt;- tbl(bety, &quot;species&quot;) %&gt;% filter(str_detect(notes, &quot;ForestGEO&quot;)) %&gt;% collect() %&gt;% nrow() PFT_species %&gt;% filter(str_detect(PFT_species$notes, &quot;ForestGEO&quot;)) %&gt;% nrow() == nForestGEO ## [1] TRUE PFT_species$notes &lt;- NULL What I need help with I need to import trait data in to the database and I need to match the species names in the data to the records in BETY. Furthermore, I need to decide if I need to add records or change existing records in BETY. I’ll refer to the species name in the data set as “submitted name” - I run these names through the TNRS to see if returns spelling corrections or a different “accepted name.” For example: If my submitted name is &quot;Simaroubu glauca&quot; (which I misspelled from Simarouba glauca) submit_name &lt;- &quot;Simaroubu glauca&quot; tnrs(query = submit_name) ## Calling http://taxosaurus.org/retrieve/eb5150511c7afa35e0bae620fbfb5205 ## submittedname acceptedname sourceid score matchedname ## 1 Simaroubu glauca Simarouba amara iPlant_TNRS 0.98 Simarouba glauca ## authority uri ## 1 Aubl. http://www.tropicos.org/Name/29400090 The iPlant TNRS matches the name Simarouba glauca but then provides an accepted name of Simarouba amara. When I use the name resolving tools, and try to match the submitted and accepted names to BETY I come up with 13 different cases that can potentially arrise. I’ll go through each one in detail below: #------------------------------------------------------------------------------# # Both the submitted and accepted names in BETY # Check if they equal each other submit_accept &lt;- sp$submit_bety_id[i] == sp$accept_bety_id[i] # They equal each other case01 &lt;- submit_bety &amp; accept_bety &amp; submit_accept &amp; accept_PFT # Best case, don&#39;t need to do anything. case02 &lt;- submit_bety &amp; accept_bety &amp; submit_accept &amp; !accept_PFT # They don&#39;t equal one another case03 &lt;- submit_bety &amp; accept_bety &amp; !submit_accept &amp; submit_PFT &amp; accept_PFT case04 &lt;- submit_bety &amp; accept_bety &amp; !submit_accept &amp; submit_PFT &amp; !accept_PFT case05 &lt;- submit_bety &amp; accept_bety &amp; !submit_accept &amp; !submit_PFT &amp; accept_PFT case06 &lt;- submit_bety &amp; accept_bety &amp; !submit_accept &amp; !submit_PFT &amp; !accept_PFT #------------------------------------------------------------------------------# # Only one name in BETY # Submitted name not in bety, accepted name in BETY case07 &lt;- !submit_bety &amp; accept_bety &amp; accept_PFT case08 &lt;- !submit_bety &amp; accept_bety &amp; !accept_PFT # Submitted name in bety, accepted name not in BETY case09 &lt;- submit_bety &amp; submit_PFT &amp; !accept_bety case10 &lt;- submit_bety &amp; !submit_PFT &amp; !accept_bety #------------------------------------------------------------------------------# # None of the names are in BETY case11 &lt;- !submit_bety &amp; !accept_bety &amp; toupper(sp$submit_name[i]) == toupper(sp$accept_name[i]) case12 &lt;- !submit_bety &amp; !accept_bety &amp; toupper(sp$submit_name[i]) != toupper(sp$accept_name[i]) #------------------------------------------------------------------------------# # Special unlucky number 13 case that the TNRS could not find an accepted name. # Or TNRS returned a blank which is super lame and confusing. # These will need to be resolved by hand. case13 &lt;- !accept_name_exists if(case13){ case01 = case02 = case03 = case04 = case05 = case06 = case07 = case08 = case09 = case10 = case11 = case12 = FALSE } Using a list of 131 species from trait data that I need to import in to BETY (from various sources), I determined the case for each name in a separate script. The result of this analysis are in the file /fs/data3/ecowdery/ED.Hydro/parameters/constraint_calculations/constraint_data/species_out.csv. species_out = read.csv(file = &quot;/fs/data3/ecowdery/ED.Hydro/parameters/constraint_calculations/constraint_data/species_out.csv&quot;, stringsAsFactors = FALSE) %&gt;% select(-one_of(c(&quot;X&quot;, &quot;X.1&quot;))) ## Warning: Unknown columns: `X.1` species_out &lt;- species_out %&gt;% mutate(category = case_when(case &lt;= 6 ~ &quot;both&quot;, 6 &lt; case &amp; case &lt;= 10 ~ &quot;one&quot;, 10 &lt; case &amp; case &lt;= 12 ~ &quot;none&quot;, case == 13 ~ &quot;by hand&quot;)) species_out$category &lt;- factor(species_out$category, levels = c(&quot;both&quot;, &quot;one&quot;, &quot;none&quot;, &quot;by hand&quot;)) # Here I color the entries by &quot;score&quot; which is just how &quot;close&quot; the match is # So the score would go down for a spelling error for example ggplot(data = species_out) + geom_bar(aes(x = as.factor(case), fill = as.factor(score))) + facet_grid(aes(cols = category), scales = &quot;free&quot;, space = &quot;free&quot;) # Special case for which the TNRS did not work, I&#39;ll get to this later species_special &lt;- species_out %&gt;% filter(case == 13) # Entries for which the TNRS did work species_case &lt;- species_out %&gt;% filter(case != 13) # dim(species_case) ggplot(data = species_case %&gt;% filter(case != 1)) + geom_bar(aes(x = as.factor(case), fill = as.factor(score))) + ggtitle(&quot;Cases I need help with&quot;) + facet_grid(aes(cols = category), scales = &quot;free&quot;, space = &quot;free&quot;) Luckily, case 1, the one in which the submitted name and accepted name agree and are in BETY and in the tropical PFT is the predominant case. However, there are a lot of other cases that need sorting through. This is where I need help! Specific places I would love opinions: case 3-6 &amp; 9-10 Cases Both the submitted and accepted names in BETY and they are the same Case 1 Submit name is in BETY Accept name is in BETY Submit name = Accept name Submit name is in PFT Accept name is in PFT This is the best case, we don’t need to do anything! my_table(species_case, 1) %&gt;% scroll_box(height = &quot;200px&quot;) submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri albizia guachapele 1000020862 TRUE Albizia guachapele 1000020862 TRUE http://www.tropicos.org/Name/13002026 alseis blackiana 49937 TRUE Alseis blackiana 49937 TRUE http://www.tropicos.org/Name/27903143 anacardium excelsum 49943 TRUE Anacardium excelsum 49943 TRUE http://www.tropicos.org/Name/1300302 annona glabra 30111 TRUE Annona glabra 30111 TRUE http://www.tropicos.org/Name/1600683 annona spraguei 49953 TRUE Annona spraguei 49953 TRUE http://www.tropicos.org/Name/1600100 ardisia palmana 1000000871 TRUE Ardisia palmana 1000000871 TRUE http://www.tropicos.org/Name/22000607 aspidosperma desmanthum 1000000969 TRUE Aspidosperma desmanthum 1000000969 TRUE http://www.tropicos.org/Name/1800106 astronium graveolens 49993 TRUE Astronium graveolens 49993 TRUE http://www.tropicos.org/Name/1300086 balfourodendron riedelianum 1000020863 TRUE Balfourodendron riedelianum 1000020863 TRUE http://www.tropicos.org/Name/28101311 bauhinia purpurea 19215 TRUE Bauhinia purpurea 19215 TRUE http://www.tropicos.org/Name/13047080 blepharocalyx salicifolius 1000001544 TRUE Blepharocalyx salicifolius 1000001544 TRUE http://www.tropicos.org/Name/22102059 brosimum utile 30553 TRUE Brosimum utile 30553 TRUE http://www.tropicos.org/Name/100300816 bursera simaruba 227 TRUE Bursera simaruba 227 TRUE http://www.tropicos.org/Name/4700231 byrsonima crassifolia 35029 TRUE Byrsonima crassifolia 35029 TRUE http://www.tropicos.org/Name/19500795 cabralea canjerana 1000001911 TRUE Cabralea canjerana 1000001911 TRUE http://www.tropicos.org/Name/20400624 calycophyllum candidissimum 41267 TRUE Calycophyllum candidissimum 41267 TRUE http://www.tropicos.org/Name/27903157 carapa guianensis 46649 TRUE Carapa guianensis 46649 TRUE http://www.tropicos.org/Name/20400362 caryocar brasiliense 10238 TRUE Caryocar brasiliense 10238 TRUE http://www.tropicos.org/Name/6200020 casearia corymbosa 1000002246 TRUE Casearia corymbosa 1000002246 TRUE http://www.tropicos.org/Name/13200097 casearia sylvestris 281 TRUE Casearia sylvestris 281 TRUE http://www.tropicos.org/Name/13200167 cassipourea guianensis 10766 TRUE Cassipourea guianensis 10766 TRUE http://www.tropicos.org/Name/27600003 cecropia obtusifolia 15822 TRUE Cecropia obtusifolia 15822 TRUE http://www.tropicos.org/Name/21300586 cedrela fissilis 1000002385 TRUE Cedrela fissilis 1000002385 TRUE http://www.tropicos.org/Name/20400355 ceiba speciosa 1000020865 TRUE Ceiba speciosa 1000020865 TRUE http://www.tropicos.org/Name/3900746 chrysophyllum cainito 28944 TRUE Chrysophyllum cainito 28944 TRUE http://www.tropicos.org/Name/28700679 chrysophyllum gonocarpum 1000002727 TRUE Chrysophyllum gonocarpum 1000002727 TRUE http://www.tropicos.org/Name/28700706 cinnamomum camphora 335 TRUE Cinnamomum camphora 335 TRUE http://www.tropicos.org/Name/17805257 clusia stenophylla 50136 TRUE Clusia stenophylla 50136 TRUE http://www.tropicos.org/Name/7800243 cochlospermum vitifolium 39878 TRUE Cochlospermum vitifolium 39878 TRUE http://www.tropicos.org/Name/8000014 cordia alliodora 380 TRUE Cordia alliodora 380 TRUE http://www.tropicos.org/Name/4001123 cordia cymosa 1000003422 TRUE Cordia cymosa 1000003422 TRUE http://www.tropicos.org/Name/4001646 cordia lasiocalyx 1000003442 TRUE Cordia lasiocalyx 1000003442 TRUE http://www.tropicos.org/Name/4000309 cordia lucidula 1000003446 TRUE Cordia lucidula 1000003446 TRUE http://www.tropicos.org/Name/4001221 cordia nodosa 1000003459 TRUE Cordia nodosa 1000003459 TRUE http://www.tropicos.org/Name/4001143 cordia panamensis 1000003460 TRUE Cordia panamensis 1000003460 TRUE http://www.tropicos.org/Name/4001223 cordia trichotoma 1000020866 TRUE Cordia trichotoma 1000020866 TRUE http://www.tropicos.org/Name/4002034 crescentia alata 5807 TRUE Crescentia alata 5807 TRUE http://www.tropicos.org/Name/3700258 croton billbergianus 1000003773 TRUE Croton billbergianus 1000003773 TRUE http://www.tropicos.org/Name/12800819 cupania guatemalensis 1000003887 TRUE Cupania guatemalensis 1000003887 TRUE http://www.tropicos.org/Name/28600609 curatella americana 1000003910 TRUE Curatella americana 1000003910 TRUE http://www.tropicos.org/Name/10900124 dendropanax latilobus 1000004162 TRUE Dendropanax latilobus 1000004162 TRUE http://www.tropicos.org/Name/2200747 drimys granadensis 1000004518 TRUE Drimys granadensis 1000004518 TRUE http://www.tropicos.org/Name/34200005 enterolobium cyclocarpum 3762 TRUE Enterolobium cyclocarpum 3762 TRUE http://www.tropicos.org/Name/13030083 erythrina costaricensis 1000004822 TRUE Erythrina costaricensis 1000004822 TRUE http://www.tropicos.org/Name/13009263 erythroxylum suberosum 1000004882 TRUE Erythroxylum suberosum 1000004882 TRUE http://www.tropicos.org/Name/12500266 eugenia nesiotica 1000005068 TRUE Eugenia nesiotica 1000005068 TRUE http://www.tropicos.org/Name/22102097 faramea occidentalis 31837 TRUE Faramea occidentalis 31837 TRUE http://www.tropicos.org/Name/27902704 ficus citrifolia 33851 TRUE Ficus citrifolia 33851 TRUE http://www.tropicos.org/Name/21300460 ficus insipida 1000005277 TRUE Ficus insipida 1000005277 TRUE http://www.tropicos.org/Name/21300606 gliricidia sepium 605 TRUE Gliricidia sepium 605 TRUE http://www.tropicos.org/Name/13048407 guapira noxia 1000005697 TRUE Guapira noxia 1000005697 TRUE http://www.tropicos.org/Name/22500694 guarea guidonia 622 TRUE Guarea guidonia 622 TRUE http://www.tropicos.org/Name/20400341 guatteria dumetorum 1000005776 TRUE Guatteria dumetorum 1000005776 TRUE http://www.tropicos.org/Name/1600214 guazuma ulmifolia 5630 TRUE Guazuma ulmifolia 5630 TRUE http://www.tropicos.org/Name/30400486 gustavia superba 1000005920 TRUE Gustavia superba 1000005920 TRUE http://www.tropicos.org/Name/17900010 hedyosmum goudotianum 1000006069 TRUE Hedyosmum goudotianum 1000006069 TRUE http://www.tropicos.org/Name/7300013 hedyosmum mexicanum 1000006073 TRUE Hedyosmum mexicanum 1000006073 TRUE http://www.tropicos.org/Name/7300015 hevea brasiliensis 19340 TRUE Hevea brasiliensis 19340 TRUE http://www.tropicos.org/Name/12801400 holocalyx balansae 1000020867 TRUE Holocalyx balansae 1000020867 TRUE http://www.tropicos.org/Name/13020477 humiriastrum diguense 1000006376 TRUE Humiriastrum diguense 1000006376 TRUE http://www.tropicos.org/Name/15800034 hymenaea courbaril 27020 TRUE Hymenaea courbaril 27020 TRUE http://www.tropicos.org/Name/13005950 hymenaea martiana 1000020868 TRUE Hymenaea martiana 1000020868 TRUE http://www.tropicos.org/Name/13020516 hymenaea stigonocarpa 1000020879 TRUE Hymenaea stigonocarpa 1000020879 TRUE http://www.tropicos.org/Name/13020524 inga vera 704 TRUE Inga vera 704 TRUE http://www.tropicos.org/Name/13021418 ipomoea wolcottiana 1000006740 TRUE Ipomoea wolcottiana 1000006740 TRUE http://www.tropicos.org/Name/8502130 kielmeyera coriacea 50498 TRUE Kielmeyera coriacea 50498 TRUE http://www.tropicos.org/Name/7801213 kleinhovia hospita 44340 TRUE Kleinhovia hospita 44340 TRUE http://www.tropicos.org/Name/30401419 lagerstroemia tomentosa 1000007008 TRUE Lagerstroemia tomentosa 1000007008 TRUE http://www.tropicos.org/Name/19200388 laguncularia racemosa 746 TRUE Laguncularia racemosa 746 TRUE http://www.tropicos.org/Name/8200077 luehea seemannii 50567 TRUE Luehea seemannii 50567 TRUE http://www.tropicos.org/Name/32200236 maclura tinctoria 39582 TRUE Maclura tinctoria 39582 TRUE http://www.tropicos.org/Name/21300516 manilkara bidentata 43171 TRUE Manilkara bidentata 43171 TRUE http://www.tropicos.org/Name/28700368 manilkara chicle 1000007816 TRUE Manilkara chicle 1000007816 TRUE http://www.tropicos.org/Name/28700413 marila laxiflora 1000007859 TRUE Marila laxiflora 1000007859 TRUE http://www.tropicos.org/Name/7800371 miconia argentea 50624 TRUE Miconia argentea 50624 TRUE http://www.tropicos.org/Name/20302666 miconia cuspidata 1000008327 TRUE Miconia cuspidata 1000008327 TRUE http://www.tropicos.org/Name/20301030 miconia minutiflora 1000008488 TRUE Miconia minutiflora 1000008488 TRUE http://www.tropicos.org/Name/20300169 morisonia americana 13503 TRUE Morisonia americana 13503 TRUE http://www.tropicos.org/Name/5900370 myriocarpa longipes 50648 TRUE Myriocarpa longipes 50648 TRUE http://www.tropicos.org/Name/33400494 myrospermum frutescens 17254 TRUE Myrospermum frutescens 17254 TRUE http://www.tropicos.org/Name/13036060 myrsine guianensis 1000009201 TRUE Myrsine guianensis 1000009201 TRUE http://www.tropicos.org/Name/22000930 ochroma pyramidale 25655 TRUE Ochroma pyramidale 25655 TRUE http://www.tropicos.org/Name/3900204 ocotea diospyrifolia 1000020870 TRUE Ocotea diospyrifolia 1000020870 TRUE http://www.tropicos.org/Name/17803863 ocotea insularis 1000009467 TRUE Ocotea insularis 1000009467 TRUE http://www.tropicos.org/Name/17800241 ouratea lucens 1000009869 TRUE Ouratea lucens 1000009869 TRUE http://www.tropicos.org/Name/22800107 parapiptadenia rigida 1000020871 TRUE Parapiptadenia rigida 1000020871 TRUE http://www.tropicos.org/Name/13011305 piper reticulatum 24509 TRUE Piper reticulatum 24509 TRUE http://www.tropicos.org/Name/25001139 piscidia carthagenensis 25287 TRUE Piscidia carthagenensis 25287 TRUE http://www.tropicos.org/Name/13031807 pithecellobium dulce 25660 TRUE Pithecellobium dulce 25660 TRUE http://www.tropicos.org/Name/13012638 poulsenia armata 50786 TRUE Poulsenia armata 50786 TRUE http://www.tropicos.org/Name/21300623 pourouma bicolor 1000011418 TRUE Pourouma bicolor 1000011418 TRUE http://www.tropicos.org/Name/21301041 prioria copaifera 50795 TRUE Prioria copaifera 50795 TRUE http://www.tropicos.org/Name/13044814 protium panamense 1000011665 TRUE Protium panamense 1000011665 TRUE http://www.tropicos.org/Name/4700236 pseudobombax septenatum 50836 TRUE Pseudobombax septenatum 50836 TRUE http://www.tropicos.org/Name/3900261 psidium sartorianum 1000011797 TRUE Psidium sartorianum 1000011797 TRUE http://www.tropicos.org/Name/22102112 qualea grandiflora 50863 TRUE Qualea grandiflora 50863 TRUE http://www.tropicos.org/Name/34100133 qualea parviflora 1000012111 TRUE Qualea parviflora 1000012111 TRUE http://www.tropicos.org/Name/34100163 rhizophora mangle 1196 TRUE Rhizophora mangle 1196 TRUE http://www.tropicos.org/Name/27600058 schefflera macrocarpa 1000020872 TRUE Schefflera macrocarpa 1000020872 TRUE http://www.tropicos.org/Name/50254555 schefflera morototoni 51206 TRUE Schefflera morototoni 51206 TRUE http://www.tropicos.org/Name/2200796 semialarium mexicanum 1000020873 TRUE Semialarium mexicanum 1000020873 TRUE http://www.tropicos.org/Name/15600396 senna dariensis 1000013190 TRUE Senna dariensis 1000013190 TRUE http://www.tropicos.org/Name/13041308 simarouba amara 50962 TRUE Simarouba amara 50962 TRUE http://www.tropicos.org/Name/29400090 spondias purpurea 24450 TRUE Spondias purpurea 24450 TRUE http://www.tropicos.org/Name/1300271 styrax ferrugineus 1000020874 TRUE Styrax ferrugineus 1000020874 TRUE http://www.tropicos.org/Name/30800015 styrax pohlii 1000020875 TRUE Styrax pohlii 1000020875 TRUE http://www.tropicos.org/Name/30800040 swietenia macrophylla 1354 TRUE Swietenia macrophylla 1354 TRUE http://www.tropicos.org/Name/20400346 symplocos lanceolata 1000020876 TRUE Symplocos lanceolata 1000020876 TRUE http://www.tropicos.org/Name/30900096 syzygium cumini 36558 TRUE Syzygium cumini 36558 TRUE http://www.tropicos.org/Name/22102113 tabebuia rosea 2834 TRUE Tabebuia rosea 2834 TRUE http://www.tropicos.org/Name/3700648 tachigali versicolor 50999 TRUE Tachigali versicolor 50999 TRUE http://www.tropicos.org/Name/13001906 tapirira guianensis 1000014356 TRUE Tapirira guianensis 1000014356 TRUE http://www.tropicos.org/Name/1300281 terminalia amazonia 1000014401 TRUE Terminalia amazonia 1000014401 TRUE http://www.tropicos.org/Name/8200207 trattinnickia aspera 1000014798 TRUE Trattinnickia aspera 1000014798 TRUE http://www.tropicos.org/Name/4700241 virola sebifera 25996 TRUE Virola sebifera 25996 TRUE http://www.tropicos.org/Name/21800101 vismia billbergiana 1000015206 TRUE Vismia billbergiana 1000015206 TRUE http://www.tropicos.org/Name/7800776 vochysia ferruginea 1000015271 TRUE Vochysia ferruginea 1000015271 TRUE http://www.tropicos.org/Name/34100141 vochysia thyrsoidea 1000020878 TRUE Vochysia thyrsoidea 1000020878 TRUE http://www.tropicos.org/Name/50184812 xylopia macrantha 1000015453 TRUE Xylopia macrantha 1000015453 TRUE http://www.tropicos.org/Name/1600511 zanthoxylum panamense 51088 TRUE Zanthoxylum panamense 51088 TRUE http://www.tropicos.org/Name/28100631 zuelania guidonia 51093 TRUE Zuelania guidonia 51093 TRUE http://www.tropicos.org/Name/13200529 Case 2 Submit name is in BETY Accept name is in BETY Submit name = Accept name Submit name is not in PFT Accept name is not in PFT This seems pretty straightforward. We don’t need to add anything to the species table. Do we add the name to the PFT? submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri aspidosperma tomentosum 49981 FALSE Aspidosperma tomentosum 49981 FALSE http://www.tropicos.org/Name/1802208 baccaurea ramiflora 14893 FALSE Baccaurea ramiflora 14893 FALSE http://www.tropicos.org/Name/50056948 barringtonia racemosa 18401 FALSE Barringtonia racemosa 18401 FALSE http://www.tropicos.org/Name/17900318 bischofia javanica 22718 FALSE Bischofia javanica 22718 FALSE http://www.tropicos.org/Name/12801991 canella winterana 45817 FALSE Canella winterana 45817 FALSE http://www.tropicos.org/Name/5600007 gnetum gnemon 48766 FALSE Gnetum gnemon 48766 FALSE http://www.tropicos.org/Name/14300128 gossia bidwillii 1000020889 FALSE Gossia bidwillii 1000020889 FALSE http://www.tropicos.org/Name/50238673 guapira 5467 FALSE Guapira 5467 FALSE http://www.tropicos.org/Name/40017912 hibiscus 19743 FALSE Hibiscus 19743 FALSE http://www.tropicos.org/Name/40025797 horsfieldia 24048 FALSE Horsfieldia 24048 FALSE http://www.tropicos.org/Name/40027709 illicium floridanum 32425 FALSE Illicium floridanum 32425 FALSE http://www.tropicos.org/Name/19300028 miconia 5736 FALSE Miconia 5736 FALSE http://www.tropicos.org/Name/40018467 nephelium lappaceum 21315 FALSE Nephelium lappaceum 21315 FALSE http://www.tropicos.org/Name/50009191 ouratea hexasperma 50687 FALSE Ouratea hexasperma 50687 FALSE http://www.tropicos.org/Name/50044290 podocarpus latifolius 1050 FALSE Podocarpus latifolius 1050 FALSE http://www.tropicos.org/Name/25600041 podocarpus neriifolius 33546 FALSE Podocarpus neriifolius 33546 FALSE http://www.tropicos.org/Name/25600056 trema orientalis 3418 FALSE Trema orientalis 3418 FALSE http://www.tropicos.org/Name/33300010 Both the submitted and accepted names in BETY and they are NOT the same This is complicated! If the submitted names in BETY are out of date, should they be replaced by the new accepted names? If we keep the submitted name species record in BETY How does this decision affect trait records linked to that species record? How does this decision affect whether or not the submitted name stays in the PFT? Should the trait data that hasn’t been entered yet be linked to the submitted name species record or the accepted name species record? Keep these questions in mind when looking through not only cases 3-6 but also 9-10 Case 3 Submit name is in BETY Accept name is in BETY Submit name != Accept name Submit name is in PFT Accept name is in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri simarouba glauca 13388 TRUE Simarouba amara 50962 TRUE http://www.tropicos.org/Name/29400090 Case 4 Submit name is in BETY Accept name is in BETY Submit name != Accept name Submit name is in PFT Accept name is not in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri Case 5 Submit name is in BETY Accept name is in BETY Submit name != Accept name Submit name is not in PFT Accept name is in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri coursetia arborea 50163 FALSE Coursetia ferruginea 1000003609 TRUE http://www.tropicos.org/Name/13069025 Case 6 Submit name is in BETY Accept name is in BETY Submit name != Accept name Submit name is not in PFT Accept name is not in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri capparis aristiguetae 50069 FALSE Capparis 46151 FALSE http://www.tropicos.org/Name/40000978 homalium moultonii 1000020882 FALSE Homalium 22750 FALSE http://www.tropicos.org/Name/40027071 nectandra purpurascens 1000020884 FALSE Nectandra 19730 FALSE http://www.tropicos.org/Name/40025736 shorea faguetiana 1000020885 FALSE Shorea 8847 FALSE http://www.tropicos.org/Name/40036194 shorea mecistopteryx 1000020886 FALSE Shorea 8847 FALSE http://www.tropicos.org/Name/40036194 trichospermum pleiostigma 1000020887 FALSE Trichospermum 5170 FALSE http://www.tropicos.org/Name/40017818 Only the accepted name is in in BETY Here there aren’t too many questions, as long as we are ok with entering the trait data under the accepted name (and potentially adding the accepted name to the PFT.) Case 7 This is where a lot of the spelling errors live. Submitted name is not in BETY Accepted name is in BETY Accepted name is in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri acinodendron pohlianum NA FALSE Miconia leucocarpa 1000020880 TRUE http://www.tropicos.org/Name/20301140 antirrhea trichantha NA FALSE Pittoniotis trichantha 1000011255 TRUE http://www.tropicos.org/Name/27903746 aspidosperma cruenta NA FALSE Aspidosperma desmanthum 1000000969 TRUE http://www.tropicos.org/Name/1800106 bauhinia variegate NA FALSE Bauhinia variegata 19251 TRUE http://www.tropicos.org/Name/13027460 bursera simarouba NA FALSE Bursera simaruba 227 TRUE http://www.tropicos.org/Name/4700231 chrysophllum cainito NA FALSE Chrysophyllum cainito 28944 TRUE http://www.tropicos.org/Name/28700679 hymenaea stignocarpa NA FALSE Hymenaea stigonocarpa 1000020879 TRUE http://www.tropicos.org/Name/13020524 hymenea courbaril NA FALSE Hymenaea courbaril 27020 TRUE http://www.tropicos.org/Name/13005950 miconia pohliana NA FALSE Miconia leucocarpa 1000020880 TRUE http://www.tropicos.org/Name/20301140 myrsine ferruginea NA FALSE Myrsine coriacea subsp. coriacea 1000020881 TRUE http://www.tropicos.org/Name/50096857 Case 8 Submitted name is not in BETY Accepted name is in BETY Accepteed name is not in PFT submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri austromyrtus bidwillii NA FALSE Gossia bidwillii 1000020889 FALSE http://www.tropicos.org/Name/50238673 eugenia ampullaria NA FALSE Syzygium ampullarium 1000020892 FALSE http://www.tropicos.org/Name/100263734 eugenia bankensis NA FALSE Syzygium bankense 1000020893 FALSE http://www.tropicos.org/Name/100263780 eugenia muelleri NA FALSE Syzygium muelleri 1000020894 FALSE http://www.tropicos.org/Name/100264357 millettia cubitti NA FALSE Millettia cubittii 1000020897 FALSE http://www.tropicos.org/Name/13060114 piptadenia constricta NA FALSE Piptadenia obliqua 1000020898 FALSE http://www.tropicos.org/Name/13012488 syzygium latilimbum NA FALSE Syzygium megacarpum 1000020899 FALSE http://www.tropicos.org/Name/50309219 Only the submitted name is in in BETY Decisions about how to handle cases 9 and 10 depend on how we choose to handle cases 3-6. Case 9 Submitted name is in BETY Submitted name is in PFT Accepted name is not in BETY Questions: Should I add the new accepted names to the database? Should the trait data that I haven’t entered yet be entered under the submitted names or the accepted names? submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri aegiphila lhotzkiana 49913 TRUE Aegiphila verticillata NA FALSE http://www.tropicos.org/Name/50214172 aegiphila sellowiana 1000000238 TRUE Aegiphila verticillata NA FALSE http://www.tropicos.org/Name/50214172 caesalpinia eriostachys 1000001917 TRUE Poincianella eriostachys NA FALSE http://www.tropicos.org/Name/13015217 capparis indica 46256 TRUE Quadrella indica NA FALSE http://www.tropicos.org/Name/50298080 lonchocarpus muehlbergianus 1000020869 TRUE Dahlstedtia muehlbergiana NA FALSE http://www.tropicos.org/Name/100381684 sclerolobium paniculatum 1000013036 TRUE Tachigali vulgaris NA FALSE http://www.tropicos.org/Name/50317942 Case 10 Submitted name is in BETY Submitted name is not in PFT Accepted name is not in BETY Questions: See all the questions associated with case 9. The answers to case 9 questions affects whether or not the submitted names in case 10 should be added to the PFT. submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri araucaria hunsteinii 1000020888 FALSE Titanodendron hunsteinii NA FALSE http://www.tropicos.org/Name/100268937 cochlospermum gillivraei 1000020890 FALSE Maximilianea gillivraei NA FALSE http://www.tropicos.org/Name/100220654 cordia inermis 1000020891 FALSE Varronia inermis NA FALSE http://www.tropicos.org/Name/50287395 drimys winteri 40294 FALSE Drimys granadensis var. mexicana NA FALSE http://www.tropicos.org/Name/34200011 harpullia cupanioides 1000020895 FALSE Harpullia ramiflora NA FALSE http://www.tropicos.org/Name/100398304 lonchocarpus dipteroneurus 49882 FALSE Lonchocarpus pubescens NA FALSE http://www.tropicos.org/Name/13022005 xerospermum laevigatum 1000020900 FALSE Xerospermum NA FALSE http://www.tropicos.org/Name/40027368 None of the names are in BETY Case 11 Submitted and Accepted name is the same and is not in BETY - do we add it? submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri adansonia rubrostipa NA FALSE Adansonia rubrostipa NA FALSE http://www.tropicos.org/Name/3900453 adansonia za NA FALSE Adansonia za NA FALSE http://www.tropicos.org/Name/3900455 alphitonia excelsa NA FALSE Alphitonia excelsa NA FALSE http://www.tropicos.org/Name/100286031 alphonsea monogyna NA FALSE Alphonsea monogyna NA FALSE http://www.tropicos.org/Name/1602752 amphipterygium adstringens NA FALSE Amphipterygium adstringens NA FALSE http://www.tropicos.org/Name/16800004 amyxa pluricornis NA FALSE Amyxa pluricornis NA FALSE http://www.tropicos.org/Name/50296273 apoplanesia paniculata NA FALSE Apoplanesia paniculata NA FALSE http://www.tropicos.org/Name/13047084 bourreria cumanensis NA FALSE Bourreria cumanensis NA FALSE http://www.tropicos.org/Name/4002683 brachychiton australis NA FALSE Brachychiton australis NA FALSE http://www.tropicos.org/Name/30401452 bursera heteresthes NA FALSE Bursera heteresthes NA FALSE http://www.tropicos.org/Name/4700022 bursera instabilis NA FALSE Bursera instabilis NA FALSE http://www.tropicos.org/Name/4700598 caesalpinia sclerocarpa NA FALSE Caesalpinia sclerocarpa NA FALSE http://www.tropicos.org/Name/13003316 celtis philippensis NA FALSE Celtis philippensis NA FALSE http://www.tropicos.org/Name/33300057 celtis tetrandra NA FALSE Celtis tetrandra NA FALSE http://www.tropicos.org/Name/33300179 cipadessa baccifera NA FALSE Cipadessa baccifera NA FALSE http://www.tropicos.org/Name/20400001 cleistanthus sumatranus NA FALSE Cleistanthus sumatranus NA FALSE http://www.tropicos.org/Name/50056473 cnidoscolus spinosus NA FALSE Cnidoscolus spinosus NA FALSE http://www.tropicos.org/Name/12805203 cordia elaeagnoides NA FALSE Cordia elaeagnoides NA FALSE http://www.tropicos.org/Name/4002674 corymbia erythrophloia NA FALSE Corymbia erythrophloia NA FALSE http://www.tropicos.org/Name/100172611 cosmibuena valerioi NA FALSE Cosmibuena valerioi NA FALSE http://www.tropicos.org/Name/27909344 croton crassifolius NA FALSE Croton crassifolius NA FALSE http://www.tropicos.org/Name/50064912 diospyros hermaphroditica NA FALSE Diospyros hermaphroditica NA FALSE http://www.tropicos.org/Name/100324663 drimys insipida NA FALSE Drimys insipida NA FALSE http://www.tropicos.org/Name/50108868 eriotheca pubescens NA FALSE Eriotheca pubescens NA FALSE http://www.tropicos.org/Name/3900479 esenbeckia nesiotica NA FALSE Esenbeckia nesiotica NA FALSE http://www.tropicos.org/Name/28100108 ficus concinna NA FALSE Ficus concinna NA FALSE http://www.tropicos.org/Name/50132046 gnetum costatum NA FALSE Gnetum costatum NA FALSE http://www.tropicos.org/Name/14300144 guapira areolata NA FALSE Guapira areolata NA FALSE http://www.tropicos.org/Name/22500644 heliocarpus pallidus NA FALSE Heliocarpus pallidus NA FALSE http://www.tropicos.org/Name/32200607 homalanthus novoguineensis NA FALSE Homalanthus novoguineensis NA FALSE http://www.tropicos.org/Name/50250189 idiospermum australiense NA FALSE Idiospermum australiense NA FALSE http://www.tropicos.org/Name/100355716 lasiococca comberi NA FALSE Lasiococca comberi NA FALSE http://www.tropicos.org/Name/50049911 macaranga denticulata NA FALSE Macaranga denticulata NA FALSE http://www.tropicos.org/Name/12800072 millettia leptobotrya NA FALSE Millettia leptobotrya NA FALSE http://www.tropicos.org/Name/13060147 oreopanax nubigenus NA FALSE Oreopanax nubigenus NA FALSE http://www.tropicos.org/Name/2200778 protium NA FALSE Protium NA FALSE http://www.tropicos.org/Name/40016610 quercus oleoides NA FALSE Quercus oleoides NA FALSE http://www.tropicos.org/Name/13100316 rehdera trinervis NA FALSE Rehdera trinervis NA FALSE http://www.tropicos.org/Name/33702467 ruprechtia fusca NA FALSE Ruprechtia fusca NA FALSE http://www.tropicos.org/Name/50148878 schefflera pittieri NA FALSE Schefflera pittieri NA FALSE http://www.tropicos.org/Name/2200765 streblus asper NA FALSE Streblus asper NA FALSE http://www.tropicos.org/Name/50064863 syzygium szemaoense NA FALSE Syzygium szemaoense NA FALSE http://www.tropicos.org/Name/22107541 trichilia dregeana NA FALSE Trichilia dregeana NA FALSE http://www.tropicos.org/Name/20400492 turpinia pomifera NA FALSE Turpinia pomifera NA FALSE http://www.tropicos.org/Name/50092419 zygogynum pancheri NA FALSE Zygogynum pancheri NA FALSE http://www.tropicos.org/Name/50197622 Case 12 Submitted and Accepted names are not the same and are not in BETY - which do we add? (See case 3-6,9-10) submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri michelia hypolampra NA FALSE Michelia gioi NA FALSE http://www.tropicos.org/Name/50333308 TNRS didn’t work Case 13 These I’m going to need to go through by hand to figure out why the queries didn’t work. submit_name submit_bety_id submit_in_PFT accept_name accept_bety_id accept_in_PFT uri byrsonima crassa 1000020864 TRUE NA FALSE symplocos mosenii 1000020877 TRUE NA FALSE agathis borneensis NA FALSE NA FALSE aglaia glabrata NA FALSE NA FALSE canarium caudatum NA FALSE NA FALSE castanopsis indica  NA FALSE NA FALSE NA cordia collococa NA FALSE NA FALSE cotylelobium burckii NA FALSE NA FALSE diospyros brachiata NA FALSE NA FALSE diospyros mindanaensis NA FALSE NA FALSE dipterocarpus globosus NA FALSE NA FALSE dryobalanops aromatica 40969 FALSE NA FALSE dryobalanops sumatrensis NA FALSE NA FALSE dussia munda NA FALSE NA FALSE galbulimima baccata NA FALSE NA FALSE heritiera sumatrana NA FALSE NA FALSE isonandra lanceolata NA FALSE NA FALSE lophopetalum subobovatum NA FALSE NA FALSE mallotus wrayi NA FALSE NA FALSE payena endertii NA FALSE NA FALSE pentace adenophora NA FALSE NA FALSE pistacia weinmannifolia NA FALSE NA FALSE santiria mollis NA FALSE NA FALSE shorea ovalis NA FALSE NA FALSE sindora leiocarpa NA FALSE NA FALSE stemonurus umbellatus NA FALSE NA FALSE tachigalia versicolor NA FALSE NA FALSE trimenia neocaledonica NA FALSE NA FALSE zygogynum baillonii NA FALSE NA FALSE zygogynum bicolor NA FALSE NA FALSE zygogynum pomiferum NA FALSE NA FALSE zygogynum queenslandianum NA FALSE NA FALSE zygogynum semecarpoides NA FALSE NA FALSE "]
]
